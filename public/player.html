<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8" />
  <title>Player Profile</title>
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <link rel="stylesheet" href="/css/scoreboard.css">
  <script src="https://cdn.jsdelivr.net/npm/chart.js@4.4.1/dist/chart.umd.min.js"></script>
  <style>
    :root {
      --bg: #111217;
      --card-bg: #181a25;
      --card-border: #26293a;
      --accent: #f7c948;
      --text-muted: rgba(255, 255, 255, 0.7);
    }

    body {
      margin: 0;
      padding: 20px;
      background: radial-gradient(circle at top left, #303144, #111217 60%);
      font-family: system-ui, -apple-system, sans-serif;
      color: #f5f5f5;
      display: flex;
      flex-direction: column;
      align-items: center;
      min-height: 100vh;
    }

    .container {
      width: 100%;
      max-width: 980px;
    }

    .page-header {
      display: flex;
      flex-direction: column;
      gap: 6px;
      margin-bottom: 12px;
    }

    .page-header h1 {
      margin: 0;
      font-size: 26px;
      letter-spacing: 0.04em;
    }

    .subtitle {
      margin: 0;
      font-size: 13px;
      color: var(--text-muted);
    }

    .back-link {
      font-size: 12px;
      text-transform: uppercase;
      letter-spacing: 0.08em;
      color: var(--accent);
      text-decoration: none;
    }

    .status {
      font-size: 13px;
      margin-bottom: 8px;
    }

    .error {
      color: #ff6b6b;
      font-size: 12px;
      margin-bottom: 8px;
    }

    .summary-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(140px, 1fr));
      gap: 12px;
      margin-bottom: 20px;
    }

    .summary-card {
      background: var(--card-bg);
      border: 1px solid var(--card-border);
      border-radius: 8px;
      padding: 12px;
      display: flex;
      flex-direction: column;
      gap: 6px;
    }

    .summary-card .label {
      font-size: 11px;
      text-transform: uppercase;
      color: var(--text-muted);
      letter-spacing: 0.05em;
    }

    .summary-card .value {
      font-size: 24px;
      font-weight: 600;
    }

    .panel {
      background: var(--card-bg);
      border: 1px solid var(--card-border);
      border-radius: 8px;
      padding: 16px;
      margin-bottom: 16px;
    }

    .panel h2 {
      margin: 0 0 12px;
      font-size: 15px;
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .breakdown-table table {
      width: 100%;
      border-collapse: collapse;
      font-size: 13px;
    }

    .breakdown-table th,
    .breakdown-table td {
      padding: 6px 8px;
      border-bottom: 1px solid var(--card-border);
      text-align: left;
    }

    .breakdown-table th {
      font-size: 11px;
      text-transform: uppercase;
      color: var(--text-muted);
    }

    .number {
      text-align: right;
    }

    .empty-state {
      font-size: 12px;
      color: var(--text-muted);
    }

    .recent-list {
      display: flex;
      flex-direction: column;
      gap: 10px;
    }

    .recent-card {
      border: 1px solid var(--card-border);
      border-radius: 6px;
      padding: 10px 12px;
      display: grid;
      grid-template-columns: 1fr;
      gap: 8px;
    }

    .recent-card strong {
      display: block;
      font-size: 12px;
      color: var(--text-muted);
      text-transform: uppercase;
      letter-spacing: 0.05em;
    }

    .recent-card span {
      font-size: 13px;
    }

    .recent-card-link {
      display: block;
      text-decoration: none;
      color: inherit;
    }

    .recent-card--scoreboard {
      padding: 0;
      border: none;
      background: transparent;
    }

    .recent-card--scoreboard .scoreboard-wrapper {
      width: 100%;
    }

    .recent-card--scoreboard .scoreboard {
      box-shadow: 0 6px 18px rgba(0, 0, 0, 0.45);
      transition: transform .12s ease, box-shadow .12s ease, border-color .12s ease;
    }

    .recent-card--scoreboard .recent-card-link:hover .scoreboard {
      transform: translateY(-1px);
      border-color: var(--accent);
      box-shadow: 0 10px 24px rgba(0, 0, 0, 0.6);
    }

    .chart-container {
      position: relative;
      width: 100%;
      height: 320px;
    }

    .recent-scoreboard {
      display: grid;
      grid-template-columns: 1fr;
      gap: 6px;
    }

    .recent-team-row {
      display: flex;
      justify-content: space-between;
      gap: 10px;
      padding: 6px 8px;
      border: 1px solid var(--card-border);
      border-radius: 6px;
      background: rgba(255, 255, 255, 0.02);
    }

    .recent-score {
      text-align: center;
      font-weight: 700;
      font-size: 16px;
      padding: 6px 0;
    }

    .recent-meta {
      color: var(--text-muted);
      font-size: 12px;
    }

    .mvp-badge--inline {
      display: inline-flex !important;
      vertical-align: middle;
      margin-left: 6px;
    }

    .player-link {
      color: var(--accent);
      text-decoration: none;
    }

    .player-link:hover {
      text-decoration: underline;
    }

    .summary-card {
      position: relative;
    }

    .summary-card .icon {
      position: absolute;
      top: 10px;
      right: 10px;
      width: 28px;
      height: 28px;
      border-radius: 8px;
      background: rgba(247, 201, 72, 0.16);
      color: var(--accent);
      display: flex;
      align-items: center;
      justify-content: center;
      font-weight: 700;
      font-size: 12px;
      letter-spacing: 0.05em;
    }

    .summary-card .icon svg {
      width: 16px;
      height: 16px;
      fill: currentColor;
    }

    .grid-two {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 12px;
    }

    .calendar {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(180px, 1fr));
      gap: 12px;
      padding-top: 6px;
    }

    .calendar-month {
      border: 1px solid var(--card-border);
      border-radius: 6px;
      padding: 8px;
    }

    .calendar-month h4 {
      margin: 0 0 6px;
      font-size: 12px;
      letter-spacing: 0.05em;
      color: var(--text-muted);
      text-transform: uppercase;
    }

    .calendar-month-grid {
      display: grid;
      grid-template-columns: repeat(7, 14px);
      gap: 3px;
    }

    .calendar-cell {
      width: 14px;
      height: 14px;
      border-radius: 2px;
      background: #1f2330;
      border: 1px solid #1f2330;
    }

    .calendar-cell.level-1 { background: #234d26; border-color: #234d26; }
    .calendar-cell.level-2 { background: #2e8b3a; border-color: #2e8b3a; }
    .calendar-cell.level-3 { background: #40c463; border-color: #40c463; }
    .calendar-cell.level-4 { background: #30e57a; border-color: #30e57a; }

    .calendar-legend {
      display: flex;
      align-items: center;
      gap: 6px;
      font-size: 11px;
      color: var(--text-muted);
      margin-top: 6px;
    }

    .legend-swatch {
      width: 12px;
      height: 12px;
      border-radius: 2px;
      border: 1px solid #1f2330;
    }

    .finance-table {
      width: 100%;
      border-collapse: collapse;
      font-size: 13px;
    }

    .finance-table th,
    .finance-table td {
      padding: 8px 10px;
      border-bottom: 1px solid var(--card-border);
    }

    .finance-table th {
      text-transform: uppercase;
      font-size: 11px;
      letter-spacing: 0.05em;
      color: var(--text-muted);
    }

    .sortable {
      cursor: pointer;
    }

    .sort-indicator {
      font-size: 10px;
      opacity: 0.6;
      margin-left: 4px;
    }

    .best-cell-good {
      color: #3ac97c;
      font-weight: 600;
    }

    .best-cell-bad {
      color: #ff6b6b;
      font-weight: 600;
    }

    .extreme-grid {
      display: grid;
      grid-template-columns: repeat(auto-fit, minmax(220px, 1fr));
      gap: 10px;
    }

    .extreme-list {
      display: flex;
      flex-direction: column;
      gap: 8px;
    }

    .stat-line {
      display: flex;
      justify-content: space-between;
      gap: 10px;
      border: 1px solid var(--card-border);
      border-radius: 6px;
      padding: 8px 10px;
      font-size: 13px;
    }

    .stat-line .label {
      color: var(--text-muted);
    }

    .stat-line .value {
      font-weight: 600;
    }

  </style>
</head>

<body>
  <div class="container">
    <header class="page-header">
      <a href="/" class="back-link">← Back to matches</a>
      <h1 id="playerName">Player</h1>
      <p id="playerSubtitle" class="subtitle"></p>
      <a href="/players" class="back-link">View all player rankings →</a>
    </header>

    <div id="status" class="status"></div>
    <div id="error" class="error"></div>

    <section class="summary-grid" id="summaryGrid">
      <div class="summary-card">
        <div class="icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" aria-label="Matches icon">
            <path d="M10.854 8.146a.5.5 0 0 1 0 .708l-3 3a.5.5 0 0 1-.708 0l-1.5-1.5a.5.5 0 0 1 .708-.708L7.5 10.793l2.646-2.647a.5.5 0 0 1 .708 0"/>
            <path d="M3.5 0a.5.5 0 0 1 .5.5V1h8V.5a.5.5 0 0 1 1 0V1h1a2 2 0 0 1 2 2v11a2 2 0 0 1-2 2H2a2 2 0 0 1-2-2V3a2 2 0 0 1 2-2h1V.5a.5.5 0 0 1 .5-.5M2 2a1 1 0 0 0-1 1v11a1 1 0 0 0 1 1h12a1 1 0 0 0 1-1V3a1 1 0 0 0-1-1z"/>
            <path d="M2.5 4a.5.5 0 0 1 .5-.5h10a.5.5 0 0 1 .5.5v1a.5.5 0 0 1-.5.5H3a.5.5 0 0 1-.5-.5z"/>
          </svg>
        </div>
        <div class="label">Matches</div>
        <div class="value" id="summaryMatches">0</div>
      </div>
      <div class="summary-card">
        <div class="icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" aria-label="Sets icon">
            <path d="M2 2.5A1.5 1.5 0 0 1 3.5 1h9A1.5 1.5 0 0 1 14 2.5v11a.5.5 0 0 1-.8.4L10.5 11 8 13.9 5.5 11 2.8 13.9a.5.5 0 0 1-.8-.4z"/>
          </svg>
        </div>
        <div class="label">Sets</div>
        <div class="value" id="summarySets">0</div>
      </div>
      <div class="summary-card">
        <div class="icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" aria-label="Wins icon">
            <path d="M2 0a2 2 0 0 0-2 2v3a4 4 0 0 0 3.356 3.938C4.07 9.45 5 10.64 5 12v1H3.5A1.5 1.5 0 0 0 2 14.5v.5h12v-.5A1.5 1.5 0 0 0 12.5 13H11v-1c0-1.36.93-2.55 2.644-3.062A4 4 0 0 0 16 5V2a2 2 0 0 0-2-2zM1 2a1 1 0 0 1 1-1h9a1 1 0 0 1 1 1v2h1.5a.5.5 0 0 1 .5.5c0 .744-.402 1.436-1.025 1.813A2 2 0 0 1 12 5.05V2a2 2 0 0 0-2-2H2a1 1 0 0 1 1 1v3.05a2 2 0 0 1-.975 1.263A2.495 2.495 0 0 1 1 4.5V2zm3.663 4.356A3 3 0 0 0 5 9c0 .272-.028.538-.082.794A4.5 4.5 0 0 1 8 13.5a4.5 4.5 0 0 1 3.082-3.706A3 3 0 0 0 11 9c0-1.335.83-2.612 2.22-3.126A5.005 5.005 0 0 1 8 10a5.005 5.005 0 0 1-4.337-3.644z"/>
          </svg>
        </div>
        <div class="label">Wins</div>
        <div class="value" id="summaryWins">0</div>
      </div>
      <div class="summary-card">
        <div class="icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" aria-label="Losses icon">
            <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"/>
            <path d="M4.285 12.433a.5.5 0 0 0 .683-.183A3.5 3.5 0 0 1 8 10.5c1.295 0 2.426.703 3.032 1.75a.5.5 0 0 0 .866-.5A4.5 4.5 0 0 0 8 9.5a4.5 4.5 0 0 0-3.898 2.25.5.5 0 0 0 .183.683M7 6.5C7 7.328 6.552 8 6 8s-1-.672-1-1.5S5.448 5 6 5s1 .672 1 1.5m4 0c0 .828-.448 1.5-1 1.5s-1-.672-1-1.5S9.448 5 10 5s1 .672 1 1.5"/>
          </svg>
        </div>
        <div class="label">Losses</div>
        <div class="value" id="summaryLosses">0</div>
      </div>
      <div class="summary-card">
        <div class="icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" aria-label="Win rate icon">
            <path fill-rule="evenodd" d="M0 0h1v15h15v1H0zm14.817 3.113a.5.5 0 0 1 .07.704l-4.5 5.5a.5.5 0 0 1-.74.037L7.06 6.767l-3.656 5.027a.5.5 0 0 1-.808-.588l4-5.5a.5.5 0 0 1 .758-.06l2.609 2.61 4.15-5.073a.5.5 0 0 1 .704-.07" />
          </svg>
        </div>
        <div class="label">Win %</div>
        <div class="value" id="summaryWinPct">0%</div>
      </div>
      <div class="summary-card">
        <div class="icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" aria-label="MVP rate icon">
            <path d="m8 .25 2.146 4.35 4.804.696-3.48 3.39.82 4.774L8 11.347l-4.29 2.253.82-4.774-3.48-3.39 4.804-.696L8 .25z" />
          </svg>
        </div>
        <div class="label">MVP %</div>
        <div class="value" id="summaryMvpPct">0%</div>
      </div>
      <div class="summary-card">
        <div class="icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" aria-label="Average winners icon">
            <path d="M8 15A7 7 0 1 1 8 1a7 7 0 0 1 0 14m0 1A8 8 0 1 0 8 0a8 8 0 0 0 0 16"/>
            <path d="M8 13A5 5 0 1 1 8 3a5 5 0 0 1 0 10m0 1A6 6 0 1 0 8 2a6 6 0 0 0 0 12"/>
            <path d="M8 11a3 3 0 1 1 0-6 3 3 0 0 1 0 6m0 1a4 4 0 1 0 0-8 4 4 0 0 0 0 8"/>
            <path d="M9.5 8a1.5 1.5 0 1 1-3 0 1.5 1.5 0 0 1 3 0"/>
          </svg>
        </div>
        <div class="label">Avg Winners</div>
        <div class="value" id="summaryAvgWinners">0</div>
      </div>
      <div class="summary-card">
        <div class="icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" aria-label="Average errors icon">
            <path d="M7.938 2.016A.13.13 0 0 1 8.002 2a.13.13 0 0 1 .063.016.15.15 0 0 1 .054.057l6.857 11.667c.036.06.035.124.002.183a.2.2 0 0 1-.054.06.1.1 0 0 1-.066.017H1.146a.1.1 0 0 1-.066-.017.2.2 0 0 1-.054-.06.18.18 0 0 1 .002-.183L7.884 2.073a.15.15 0 0 1 .054-.057m1.044-.45a1.13 1.13 0 0 0-1.96 0L.165 13.233c-.457.778.091 1.767.98 1.767h13.713c.889 0 1.438-.99.98-1.767z"/>
            <path d="M7.002 12a1 1 0 1 1 2 0 1 1 0 0 1-2 0M7.1 5.995a.905.905 0 1 1 1.8 0l-.35 3.507a.552.552 0 0 1-1.1 0z"/>
          </svg>
        </div>
        <div class="label">Avg Errors</div>
        <div class="value" id="summaryAvgErrors">0</div>
      </div>
      <div class="summary-card">
        <div class="icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" aria-label="Time playing icon">
            <path d="M8.515 1.019A7 7 0 0 0 8 1V0a8 8 0 0 1 .589.022zm2.004.45a7 7 0 0 0-.985-.299l.219-.976q.576.129 1.126.342zm1.37.71a7 7 0 0 0-.439-.27l.493-.87a8 8 0 0 1 .979.654l-.615.789a7 7 0 0 0-.418-.302zm1.834 1.79a7 7 0 0 0-.653-.796l.724-.69q.406.429.747.91zm.744 1.352a7 7 0 0 0-.214-.468l.893-.45a8 8 0 0 1 .45 1.088l-.95.313a7 7 0 0 0-.179-.483m.53 2.507a7 7 0 0 0-.1-1.025l.985-.17q.1.58.116 1.17zm-.131 1.538q.05-.254.081-.51l.993.123a8 8 0 0 1-.23 1.155l-.964-.267q.069-.247.12-.501m-.952 2.379q.276-.436.486-.908l.914.405q-.24.54-.555 1.038zm-.964 1.205q.183-.183.35-.378l.758.653a8 8 0 0 1-.401.432z" />
            <path d="M8 1a7 7 0 1 0 4.95 11.95l.707.707A8.001 8.001 0 1 1 8 0z" />
            <path d="M7.5 3a.5.5 0 0 1 .5.5v5.21l3.248 1.856a.5.5 0 0 1-.496.868l-3.5-2A.5.5 0 0 1 7 9V3.5a.5.5 0 0 1 .5-.5" />
          </svg>
        </div>
        <div class="label">Time Playing</div>
        <div class="value" id="summaryTimePlaying">0:00</div>
      </div>
      <div class="summary-card">
        <div class="icon">
          <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 16 16" aria-label="Total spent icon">
            <path d="M4 9.42h1.063C5.4 12.323 7.317 14 10.34 14c.622 0 1.167-.068 1.659-.185v-1.3c-.484.119-1.045.17-1.659.17-2.1 0-3.455-1.198-3.775-3.264h4.017v-.928H6.497v-.936q-.002-.165.008-.329h4.078v-.927H6.618c.388-1.898 1.719-2.985 3.723-2.985.614 0 1.175.05 1.659.177V2.194A6.6 6.6 0 0 0 10.341 2c-2.928 0-4.82 1.569-5.244 4.3H4v.928h1.01v1.265H4v.928z"/>
          </svg>
        </div>
        <div class="label">Total Spent</div>
        <div class="value" id="summarySpent">€0.00</div>
      </div>
    </section>

    <section class="panel">
      <h2>Impact by Set</h2>
      <div style="display:flex;gap:8px;align-items:center;margin-bottom:8px;">
        <label for="impactFilter" style="font-size:12px;color:var(--text-muted);text-transform:uppercase;letter-spacing:0.05em;">Filter</label>
        <select id="impactFilter" style="background:var(--card-bg);color:#f5f5f5;border:1px solid var(--card-border);padding:6px 8px;border-radius:6px;">
          <option value="all">All sets</option>
        </select>
      </div>
      <div class="chart-container">
        <canvas id="playerImpactChart"></canvas>
      </div>
      <div id="impactEmpty" class="empty-state" style="display:none;">No set impact data yet.</div>
    </section>

    <section class="panel">
      <h2>Recent Matches</h2>
      <div id="recentMatches" class="recent-list"></div>
    </section>

    <section class="panel">
      <h2>By Match Type</h2>
      <div id="breakdownType" class="breakdown-table"></div>
    </section>

    <section class="panel">
      <h2>By Location</h2>
      <div id="breakdownLocation" class="breakdown-table"></div>
    </section>

    
    <section class="panel">
      <h2>By Day of Week</h2>
      <div id="breakdownDay" class="breakdown-table"></div>
    </section>

    <section class="panel">
      <h2>By Match Level</h2>
      <div id="breakdownLevel" class="breakdown-table"></div>
    </section>

    <section class="panel">
      <h2>By Time of Match</h2>
      <div id="breakdownTime" class="breakdown-table"></div>
    </section>

<section class="panel">
      <h2>By Partner</h2>
      <div id="breakdownPartner" class="breakdown-table"></div>
    </section>

    <section class="panel">
      <h2>By Opponent</h2>
      <div id="breakdownOpponent" class="breakdown-table"></div>
    </section>


    <section class="panel">
      <h2>Finance</h2>
      <div class="grid-two">
        <div>
          <div class="label">Total Spent</div>
          <div class="value" id="financeTotal">€0.00</div>
        </div>
      </div>
      <div class="grid-two" style="margin-top:12px;">
        <div>
          <h3 style="margin:0 0 8px;font-size:13px;text-transform:uppercase;letter-spacing:0.05em;color:var(--text-muted);">By Month</h3>
          <table class="finance-table" id="financeByMonth"></table>
        </div>
        <div>
          <h3 style="margin:0 0 8px;font-size:13px;text-transform:uppercase;letter-spacing:0.05em;color:var(--text-muted);">By Location</h3>
          <table class="finance-table" id="financeByLocation"></table>
        </div>
      </div>
    </section>

    <section class="panel">
      <h2>Match Calendar</h2>
      <div id="matchCalendar" class="calendar"></div>
    </section>
  </div>

  <script type="module" src="/js/player.js"></script>
</body>
</html>
